<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<meta name="theme-color" content="#000000">
<title>CHOSETRON 2000</title>

<style>
:root {
  --metal-dark: #1c1c1c;
  --metal-mid: #2b2b2b;
  --metal-light: #3a3a3a;
  --edge: #0a0a0a;
  --screen-green: #66ff66;
  --screen-glow: rgba(102,255,102,0.6);
  --fire-dark: #140707;
  --fire-mid: #5a1200;
  --fire-bright: #c22d00;
}

body {
  margin: 0;
  min-height: 100vh;
  padding: 20px;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  align-items: center;
  font-family: Arial, Helvetica, sans-serif;
  color: white;
  background:
    radial-gradient(circle at 20% 20%, var(--fire-bright), transparent 50%),
    radial-gradient(circle at 80% 80%, var(--fire-mid), transparent 50%),
    linear-gradient(180deg, var(--fire-dark), #000);
}

h1 {
  font-size: 36px;
  font-weight: 900;
  text-transform: uppercase;
  letter-spacing: 3px;
  margin: 20px 0 30px;
  color: #ffb347;
  text-shadow: 0 4px 0 #000;
}

.glass {
  background: linear-gradient(145deg, var(--metal-light), var(--metal-dark));
  border: 4px solid var(--edge);
  border-radius: 16px;
  padding: 24px;
  width: 100%;
  max-width: 520px;
  box-sizing: border-box;
  box-shadow:
    inset 0 2px 3px rgba(255,255,255,0.05),
    inset 0 -3px 6px rgba(0,0,0,0.7),
    0 12px 30px rgba(0,0,0,0.8);
}

textarea,
input {
  width: 100%;
  padding: 16px;
  margin-bottom: 16px;
  box-sizing: border-box;
  background: black;
  border: 3px solid #111;
  border-radius: 8px;
  color: var(--screen-green);
  font-family: monospace;
  font-size: 16px;
  box-shadow:
    inset 0 0 12px rgba(0,0,0,0.9),
    0 0 6px var(--screen-glow);
}

textarea::placeholder,
input::placeholder {
  color: rgba(102,255,102,0.4);
}

button {
  width: 100%;
  padding: 18px;
  margin: 8px 0;
  box-sizing: border-box;
  font-size: 16px;
  font-weight: 800;
  text-transform: uppercase;
  border-radius: 8px;
  border: 3px solid black;
  cursor: pointer;
  transition: transform 0.1s ease;
}

button:active {
  transform: translateY(2px);
}

.primary { background: linear-gradient(#ff7a00, #a63300); color: white; }
.keep { background: linear-gradient(#33cc33, #1b6b1b); color: white; }
.danger { background: linear-gradient(#ff3b30, #8b0000); color: white; }
.secondary { background: linear-gradient(#555, #222); color: white; }

.card {
  background: black;
  border: 3px solid #222;
  padding: 30px;
  margin: 14px 0;
  font-family: monospace;
  font-size: 20px;
  text-align: center;
  color: var(--screen-green);
  box-shadow:
    inset 0 0 15px rgba(0,0,0,0.9),
    0 0 8px var(--screen-glow);
}

#robot {
  font-family: monospace;
  color: var(--screen-green);
  margin-bottom: 16px;
  text-shadow: 0 0 5px var(--screen-glow);
}

.progress {
  height: 8px;
  background: #111;
  border: 2px solid #000;
  border-radius: 4px;
  overflow: hidden;
  margin: 10px 0 20px;
}

.progress-bar {
  height: 100%;
  width: 0%;
  background: #00ff66;
  transition: width 0.3s ease;
}

#results h2 {
  text-transform: uppercase;
  margin-top: 20px;
  color: #ffb347;
}

.hidden { display: none; }
</style>
</head>

<body>

<h1>CHOSETRON 2000</h1>

<div id="setup" class="glass">
<textarea id="items" rows="6" placeholder="ENTER LIST ITEMS (ONE PER LINE)"></textarea>
<input type="number" id="target" placeholder="TARGET NUMBER TO KEEP">
<button class="primary" onclick="start()">START</button>
</div>

<div id="compare" class="glass hidden">
<div id="robot"></div>
<div class="progress"><div class="progress-bar" id="progress"></div></div>
<div id="counter"></div>

<div class="card" id="cardA"></div>
<button class="primary" onclick="choose('A')">CHOOSE A</button>

<div class="card" id="cardB"></div>
<button class="primary" onclick="choose('B')">CHOOSE B</button>

<button class="keep" onclick="forceKeep('A')">FORCE KEEP A</button>
<button class="keep" onclick="forceKeep('B')">FORCE KEEP B</button>

<button class="danger" onclick="forceDiscard('A')">DISCARD A</button>
<button class="danger" onclick="forceDiscard('B')">DISCARD B</button>

<button class="secondary" onclick="goBack()">BACK</button>
<button class="secondary" onclick="resetAll()">RESET</button>
</div>

<div id="results" class="glass hidden"></div>

<script>
let items=[], target=0;
let stack=[], left=[], right=[], merged=[];
let history=[];
let keepForced=[], discardForced=[];
let comparisons=0;
let estimatedTotal=0;

const robotLines=[
"OVERWHELM DETECTED.",
"HESITATION LOGGED.",
"PREFERENCE MATRIX FORMING.",
"YOU CANNOT ESCAPE PRIORITY.",
"ANALYSING INDECISION.",
"YOU REQUIRE STRUCTURE.",
"CONSISTENCY RISING.",
"ALMOST COMPLETE.",
"STAY FOCUSED."
];

function haptic(){
  if(navigator.vibrate) navigator.vibrate(10);
}

function robot(){
  return robotLines[Math.floor(Math.random()*robotLines.length)];
}

function start(){
  items=document.getElementById("items").value.split("\n").map(x=>x.trim()).filter(Boolean);
  target=parseInt(document.getElementById("target").value);

  if(!items.length||!target||target>items.length){ alert("CHECK INPUTS"); return; }

  stack=items.map(i=>[i]);
  estimatedTotal=Math.ceil(items.length*Math.log2(items.length));
  comparisons=0;
  history=[];
  keepForced=[];
  discardForced=[];

  document.getElementById("setup").classList.add("hidden");
  document.getElementById("compare").classList.remove("hidden");

  nextMerge();
}

function nextMerge(){
  if(stack.length===1){ finish(); return; }
  left=stack.shift();
  right=stack.shift();
  merged=[];
  show();
}

function show(){
  if(!left.length){ stack.push(merged.concat(right)); nextMerge(); return; }
  if(!right.length){ stack.push(merged.concat(left)); nextMerge(); return; }

  document.getElementById("cardA").innerText=left[0];
  document.getElementById("cardB").innerText=right[0];
  document.getElementById("robot").innerText=robot();
  document.getElementById("counter").innerText="COMPARISON "+comparisons+" OF ~"+estimatedTotal;
  document.getElementById("progress").style.width=Math.min((comparisons/estimatedTotal)*100,100)+"%";
}

function choose(side){
  history.push({left:[...left],right:[...right],merged:[...merged],stack:[...stack]});
  comparisons++;
  haptic();
  if(side==="A"){ merged.push(left.shift()); }
  else{ merged.push(right.shift()); }
  show();
}

function forceKeep(side){
  haptic();
  if(side==="A"){ keepForced.push(left.shift()); }
  else{ keepForced.push(right.shift()); }
  show();
}

function forceDiscard(side){
  haptic();
  if(side==="A"){ discardForced.push(left.shift()); }
  else{ discardForced.push(right.shift()); }
  show();
}

function goBack(){
  if(!history.length)return;
  let prev=history.pop();
  left=prev.left;
  right=prev.right;
  merged=prev.merged;
  stack=prev.stack;
  comparisons--;
  show();
}

function finish(){
  let ranked=stack[0];
  ranked=keepForced.concat(ranked.filter(x=>!keepForced.includes(x)));
  ranked=ranked.filter(x=>!discardForced.includes(x));

  let keep=ranked.slice(0,target);
  let discard=ranked.slice(target).concat(discardForced);

  document.getElementById("compare").classList.add("hidden");
  document.getElementById("results").classList.remove("hidden");
  document.getElementById("results").innerHTML=
    "<h2>KEEP</h2>"+keep.join("<br>")+
    "<h2>DISCARD</h2>"+discard.join("<br>")+
    "<button class='primary' onclick='resetAll()'>START OVER</button>";
}

function resetAll(){ location.reload(); }
</script>

</body>
</html>
